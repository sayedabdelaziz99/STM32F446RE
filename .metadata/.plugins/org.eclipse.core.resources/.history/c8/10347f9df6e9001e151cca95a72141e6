#include "GPIO_driver.h"
#include "I2C_driver.h"
#include "RTC_driver.h"
#include "bsp.h"

void I2C_Config(I2C_Handle *pI2CHandle);
int main(void){
	I2C_Handle RTC;
	I2C_Config(&RTC);
	//RTC_SetTime(&RTC);
	uint8_t data[7];
	while(1){
		delay(50);
		RTC_ReadTime(data, &RTC);
	}
}


void I2C_Config(I2C_Handle *pI2CHandle){
	I2C1_GPIOInit(GPIOB, GPIO_PIN_NO_6, 4);
	I2C1_GPIOInit(GPIOB, GPIO_PIN_NO_7, 4);

	pI2CHandle->pI2Cx = I2C1;
	pI2CHandle->I2C_Config.I2C_SCLSpeed = I2C_SCL_SM;
	pI2CHandle->I2C_Config.I2C_DeviceAddress = 0x68U;
	pI2CHandle->I2C_Config.I2C_ACKControl = I2C_ACK_ENABLE;
	pI2CHandle->I2C_Config.I2C_AddressMode = I2C_AddressMode_7bit;
	I2C_CLKCNT(pI2CHandle->pI2Cx, ENABLE);
	I2C_Init(pI2CHandle);
}
